<html>
<head>
    <title>leaflet map</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="imagetoolbar" content="no"/>
    <link rel="stylesheet" type="text/css" href="leaflet-1.0.0-rc2/leaflet.css"/>
    <style type="text/css">
            html, body {
                margin: 0;
                padding: 0;
                width: 100%;
                height: 100%;
            }
            #map {
                width:100%;
                height:100%;
            }
            button {
                position: absolute;
                z-index: 1000;
            }
            #routeButton {
                left: 30px;
                top: 10px;
            }
            #clearButton {
                left: 100px;
                top: 10px;
            }

    </style>
</head>
<body>
<div id="map"></div>
<button id="routeButton">route</button>
<button id="clearButton">clear</button>

<script type="text/javascript" src="leaflet-1.0.0-rc2/leaflet.js"></script>
<script type="text/javascript">
            window.MapManager = {
                
                map: null,
                markers: [],
                polylines: [],
                point: null,
                
                // 地図初期化
                init: function () {
                    // create a map in the "map" div,
                    // set the view to a given place and zoom
                    // zoom : 0~18
                    this.map = L.map("map", {
                        zoomControl: false
                    });
                    this.map.setView([35.375499, 139.461690], 12);

                    // add an OpenStreetMap tile layer
                    var tileLayer = L.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png", {
                    });
                    tileLayer.addTo(this.map);
                    // Don't show the 'Powered by Leaflet' text.
                    this.map.attributionControl.setPrefix("");
                    
                    // add control zoom
                    L.control.zoom({
                        position: "bottomright"
                    }).addTo(this.map);
                },
                
                // 現在地設定 (GPSで取得した座標をセットする)
                setPoint: function (lat, lng) {
                    if (this.point) {
                        this.point.setLatLng([lat, lng]);
                    } else {
                        this.point = L.marker([lat, lng], {
                            icon: L.icon({
                                iconUrl: "./img/point.png",
                                iconSize: [16, 16],
                                iconAnchor: [8, 8]
                            })
                        });
                        this.point.addTo(this.map);
                    }
                },
                
                // マーカー追加
                addMarker: function (lat, lng) {
                    var mk = L.marker([lat, lng]);
                    mk.addTo(this.map);
                },
                
                // ポリゴン追加
                addPolygon: function (d) {
                    var pg = L.polygon(d);
                    pg.addTo(this.map);
                },
                
                // ポリライン追加
                addPolyline: function (d) {
                    var pl = L.polyline(d, {
                        color: "#33f",
                        weight: 5,
                        opacity: 0.6
                    });
                    pl.addTo(this.map);
                    this.polylines.push(pl);
                },
                
                // ポリラインクリア
                clearPolyline: function () {
                    while(this.polylines.length > 0) {
                        this.map.removeLayer(this.polylines.pop());
                    }
                }
            }
            
            //leaflet OSM map
            window.onload = function init() {
                   //alert("onload");
                MapManager.init();
                
                MapManager.setPoint(35.681504, 139.737704);
                
                MapManager.addMarker(35.685851, 139.730797);
                
                MapManager.addPolygon([
                    [35.6816, 139.7376],
                    [35.6816, 139.7378],
                    [35.6814, 139.7378],
                    [35.6814, 139.7376]
                ]);


                 MapManager.addPolyline([
                        [35.34857,139.510148],
                        [35.347086,139.511319],
                        [35.34575,139.508376],
                        [35.345428,139.508588],
                        [35.344883,139.508649],
                        [35.344487,139.508679],
                        [35.344163,139.509301],
                        [35.343962,139.509451],
                        [35.343787,139.509559],
                        [35.343586,139.50972],
                        [35.343393,139.509934],
                        [35.34292,139.510717],
                        [35.342675,139.510943],
                        [35.341652,139.511222],
                        [35.341153,139.51164],
                        [35.340357,139.512166],
                        [35.336551,139.510308],
                        [35.331996,139.498655],
                        [35.330711,139.498783],
                        [35.330083,139.500387],
                        [35.329575,139.500366],
                        [35.329033,139.500108],
                        [35.328612,139.500323],
                        [35.328227,139.500387],
                        [35.327877,139.500173],
                        [35.327054,139.498864],
                        [35.326724,139.498787],
                        [35.326182,139.498487],
                        [35.325954,139.498315],
                        [35.325578,139.498047],
                        [35.32167,139.49641],
                        [35.318939,139.496624],
                        [35.318116,139.496392],
                        [35.317831,139.496423],
                        [35.318016,139.49574],
                        [35.317311,139.495118],
                        [35.31715,139.494541],
                        [35.315912,139.494131],
                        [35.315203,139.493691],
                        [35.314327,139.493316],
                        [35.314187,139.492876],
                        [35.314141,139.49256],
                        [35.314005,139.492037],
                        [35.31388,139.491915],
                        [35.313802,139.491274],
                        [35.313673,139.491049],
                        [35.313676,139.490884],
                        [35.313623,139.490195],
                        [35.313476,139.489828],
                        [35.313281,139.489855],
                        [35.313182,139.489634],
                        [35.313046,139.489482],
                        [35.312793,139.489044],
                        [35.312261,139.48923],
                        [35.31208,139.489336],
                        [35.311476,139.490552],
                        [35.310692,139.489916],
                        [35.310118,139.489286],
                        [35.31008,139.489258],
                        [35.309684,139.489031],
                        [35.308414,139.488259],
                        [35.308409,139.488784],
                        [35.307764,139.488698],
                        [35.307673,139.488006],
                        [35.307675,139.4874],
                        [35.307553,139.4868],
                        [35.307129,139.485743],
                        [35.30618,139.484055],
                        [35.303398,139.481565],
                        [35.299163,139.487877],
                        [35.297628,139.483598],
                        [35.297479,139.481262],
                        [35.297454,139.475102],
                        [35.299089,139.473827],
                        [35.300439,139.476771],
                        [35.302878,139.481064],
                        [35.305354,139.481793],
                        [35.307843,139.480192],
                        [35.315146,139.469635],
                        [35.319528,139.438696],
                        [35.331313,139.443491],
                        [35.331803,139.443149],
                        [35.332325,139.44314],
                        [35.332384,139.442639],
                        [35.332811,139.442472],
                        [35.332839,139.442546],
                        [35.332981,139.442578],
                        [35.333062,139.442321],
                        [35.333447,139.442458],
                        [35.333454,139.442544],
                        [35.33357,139.442564],
                        [35.333625,139.442352],
                        [35.333772,139.442388],
                        [35.333964,139.442517],
                        [35.333846,139.442706],
                        [35.334004,139.442887],
                        [35.334142,139.443004],
                        [35.334221,139.443051],
                        [35.334201,139.443184],
                        [35.335058,139.443807],
                        [35.335285,139.443866],
                        [35.335309,139.443806],
                        [35.336043,139.44379],
                        [35.337621,139.443801],
                        [35.338825,139.444198],
                        [35.352977,139.440564],
                        [35.359687,139.438272],
                        [35.361453,139.43672],
                        [35.363513,139.436937],
                        [35.364617,139.440058],
                        [35.368531,139.441755],
                        [35.36962,139.438849],
                        [35.368634,139.435403],
                        [35.368104,139.434555],
                        [35.368325,139.433472],
                        [35.370385,139.432985],
                        [35.3709,139.434248],
                        [35.373916,139.433238],
                        [35.372739,139.43239],
                        [35.372695,139.431794],
                        [35.370267,139.430495],
                        [35.370473,139.428474],
                        [35.372949,139.430276],
                        [35.375853,139.430632],
                        [35.380682,139.433494],
                        [35.38533,139.415522],
                        [35.380044,139.402069],
                        [35.384522,139.399945],
                        [35.388505,139.402918],
                        [35.390043,139.403889],
                        [35.391093,139.400306],
                        [35.392267,139.398536],
                        [35.402009,139.403525],
                        [35.403321,139.405982],
                        [35.40523,139.407027],
                        [35.407746,139.40726],
                        [35.411863,139.411547],
                        [35.412545,139.411139],
                        [35.414204,139.412013],
                        [35.416267,139.413649],
                        [35.418714,139.412853],
                        [35.4186,139.413221],
                        [35.417603,139.418702],
                        [35.41782,139.41923],
                        [35.417831,139.419263],
                        [35.417676,139.419496],
                        [35.417034,139.420081],
                        [35.417458,139.420351],
                        [35.417493,139.420207],
                        [35.417635,139.420228],
                        [35.417381,139.420459],
                        [35.416778,139.420851],
                        [35.416665,139.421996],
                        [35.416004,139.424251],
                        [35.417775,139.424906],
                        [35.419941,139.424665],
                        [35.419471,139.430348],
                        [35.416932,139.434959],
                        [35.41287,139.441873],
                        [35.407624,139.441444],
                        [35.407558,139.444717],
                        [35.407411,139.449112],
                        [35.408419,139.449384],
                        [35.40915,139.449524],
                        [35.410371,139.451338],
                        [35.410965,139.452069],
                        [35.41064,139.452095],
                        [35.410795,139.452399],
                        [35.410639,139.453279],
                        [35.411181,139.453683],
                        [35.411317,139.453777],
                        [35.411243,139.453821],
                        [35.410925,139.453923],
                        [35.410974,139.454473],
                        [35.410865,139.454799],
                        [35.410239,139.45453],
                        [35.409204,139.455072],
                        [35.410393,139.454852],
                        [35.410874,139.456376],
                        [35.411717,139.456623],
                        [35.424248,139.449873],
                        [35.424877,139.449454],
                        [35.426101,139.449905],
                        [35.426591,139.449916],
                        [35.427229,139.449916],
                        [35.427054,139.450506],
                        [35.426477,139.451857],
                        [35.425953,139.453091],
                        [35.425358,139.453563],
                        [35.425052,139.453874],
                        [35.424676,139.454561],
                        [35.424947,139.455065],
                        [35.424641,139.455559],
                        [35.424606,139.455848],
                        [35.424186,139.456127],
                        [35.423706,139.456245],
                        [35.423592,139.456685],
                        [35.423627,139.457361],
                        [35.424041,139.458011],
                        [35.423565,139.45817],
                        [35.424109,139.458535],
                        [35.423849,139.459369],
                        [35.423008,139.459824],
                        [35.422674,139.460006],
                        [35.422303,139.460105],
                        [35.422244,139.460779],
                        [35.422821,139.461884],
                        [35.42317,139.462378],
                        [35.423433,139.463451],
                        [35.42345,139.464824],
                        [35.423651,139.466929],
                        [35.423563,139.470923],
                        [35.422348,139.473144],
                        [35.421998,139.474163],
                        [35.420835,139.475987],
                        [35.419559,139.477854],
                        [35.417124,139.477495],
                        [35.416101,139.477114],
                        [35.414438,139.475829],
                        [35.412694,139.476118],
                        [35.408292,139.475543],
                        [35.40374,139.475336],
                        [35.402,139.47474],
                        [35.398963,139.477167],
                        [35.396545,139.477008],
                        [35.395203,139.47722],
                        [35.393744,139.478039],
                        [35.391252,139.479562],
                        [35.389147,139.481184],
                        [35.388346,139.483136],
                        [35.389372,139.481057],
                        [35.387854,139.483532],
                        [35.386473,139.484445],
                        [35.383823,139.484922],
                        [35.381417,139.487244],
                        [35.378042,139.492439],
                        [35.373658,139.489967],
                        [35.371068,139.488379],
                        [35.365698,139.48818],
                        [35.360413,139.485578],
                        [35.359556,139.485455],
                        [35.358391,139.489142],
                        [35.358807,139.489308],
                        [35.358422,139.491005],
                        [35.358496,139.492615],
                        [35.357122,139.495479],
                        [35.355731,139.502517],
                        [35.3532,139.50496],
                        [35.350889,139.503523],
                        [35.351885,139.505536],
                        [35.352115,139.505798],
                        [35.352026,139.506189],
                        [35.351886,139.506147],
                        [35.351639,139.506693],
                        [35.351809,139.506809],
                        [35.351991,139.506904],
                        [35.351888,139.507105],
                        [35.351796,139.507332],
                        [35.351741,139.507325],
                        [35.351326,139.507036],
                        [35.351134,139.507257],
                        [35.351077,139.507276],
                        [35.350979,139.507121],
                        [35.350853,139.5072],
                        [35.351054,139.507705],
                        [35.351185,139.507883],
                        [35.351348,139.508067],
                        [35.351709,139.508388],
                        [35.351903,139.508392],
                        [35.352003,139.508549],
                        [35.351935,139.508792],
                        [35.351723,139.50883],
                        [35.351417,139.508768],
                        [35.351335,139.508914],
                        [35.351067,139.508842],
                        [35.351052,139.508636],
                        [35.351104,139.508559],
                        [35.351056,139.50844],
                        [35.350966,139.508445],
                        [35.350732,139.508697],
                        [35.350645,139.508939],
                        [35.350266,139.508848],
                        [35.349907,139.508767],
                        [35.349798,139.508781],
                        [35.349662,139.508729],
                        [35.349572,139.508946],
                        [35.349211,139.509424],
                        [35.348807,139.509464],
                        [35.349625,139.508807],
                        [35.349487,139.509011],
                        [35.349384,139.509171],
                        [35.349294,139.509273],
                        [35.349172,139.509461],
                        [35.348971,139.509432],
                        [35.348911,139.509904],
                        [35.348893,139.510013],
                        [35.34888,139.510083],
                        [35.348854,139.510203],
                        [35.348825,139.51027],
                        [35.348797,139.510302],
                        [35.34857,139.510148]
                    ]);
                
                // routeボタン
                document.getElementById("routeButton").addEventListener("click", function () {
                //alert("stam");
                    MapManager.addPolyline([
                        [35.34857,139.510148],
                        [35.347086,139.511319],
                        [35.34575,139.508376],
                        [35.345428,139.508588],
                        [35.344883,139.508649],
                        [35.344487,139.508679],
                        [35.344163,139.509301],
                        [35.343962,139.509451],
                        [35.343787,139.509559],
                        [35.343586,139.50972],
                        [35.343393,139.509934],
                        [35.34292,139.510717],
                        [35.342675,139.510943],
                        [35.341652,139.511222],
                        [35.341153,139.51164],
                        [35.340357,139.512166],
                        [35.336551,139.510308],
                        [35.331996,139.498655],
                        [35.330711,139.498783],
                        [35.330083,139.500387],
                        [35.329575,139.500366],
                        [35.329033,139.500108],
                        [35.328612,139.500323],
                        [35.328227,139.500387],
                        [35.327877,139.500173],
                        [35.327054,139.498864],
                        [35.326724,139.498787],
                        [35.326182,139.498487],
                        [35.325954,139.498315],
                        [35.325578,139.498047],
                        [35.32167,139.49641],
                        [35.318939,139.496624],
                        [35.318116,139.496392],
                        [35.317831,139.496423],
                        [35.318016,139.49574],
                        [35.317311,139.495118],
                        [35.31715,139.494541],
                        [35.315912,139.494131],
                        [35.315203,139.493691],
                        [35.314327,139.493316],
                        [35.314187,139.492876],
                        [35.314141,139.49256],
                        [35.314005,139.492037],
                        [35.31388,139.491915],
                        [35.313802,139.491274],
                        [35.313673,139.491049],
                        [35.313676,139.490884],
                        [35.313623,139.490195],
                        [35.313476,139.489828],
                        [35.313281,139.489855],
                        [35.313182,139.489634],
                        [35.313046,139.489482],
                        [35.312793,139.489044],
                        [35.312261,139.48923],
                        [35.31208,139.489336],
                        [35.311476,139.490552],
                        [35.310692,139.489916],
                        [35.310118,139.489286],
                        [35.31008,139.489258],
                        [35.309684,139.489031],
                        [35.308414,139.488259],
                        [35.308409,139.488784],
                        [35.307764,139.488698],
                        [35.307673,139.488006],
                        [35.307675,139.4874],
                        [35.307553,139.4868],
                        [35.307129,139.485743],
                        [35.30618,139.484055],
                        [35.303398,139.481565],
                        [35.299163,139.487877],
                        [35.297628,139.483598],
                        [35.297479,139.481262],
                        [35.297454,139.475102],
                        [35.299089,139.473827],
                        [35.300439,139.476771],
                        [35.302878,139.481064],
                        [35.305354,139.481793],
                        [35.307843,139.480192],
                        [35.315146,139.469635],
                        [35.319528,139.438696],
                        [35.331313,139.443491],
                        [35.331803,139.443149],
                        [35.332325,139.44314],
                        [35.332384,139.442639],
                        [35.332811,139.442472],
                        [35.332839,139.442546],
                        [35.332981,139.442578],
                        [35.333062,139.442321],
                        [35.333447,139.442458],
                        [35.333454,139.442544],
                        [35.33357,139.442564],
                        [35.333625,139.442352],
                        [35.333772,139.442388],
                        [35.333964,139.442517],
                        [35.333846,139.442706],
                        [35.334004,139.442887],
                        [35.334142,139.443004],
                        [35.334221,139.443051],
                        [35.334201,139.443184],
                        [35.335058,139.443807],
                        [35.335285,139.443866],
                        [35.335309,139.443806],
                        [35.336043,139.44379],
                        [35.337621,139.443801],
                        [35.338825,139.444198],
                        [35.352977,139.440564],
                        [35.359687,139.438272],
                        [35.361453,139.43672],
                        [35.363513,139.436937],
                        [35.364617,139.440058],
                        [35.368531,139.441755],
                        [35.36962,139.438849],
                        [35.368634,139.435403],
                        [35.368104,139.434555],
                        [35.368325,139.433472],
                        [35.370385,139.432985],
                        [35.3709,139.434248],
                        [35.373916,139.433238],
                        [35.372739,139.43239],
                        [35.372695,139.431794],
                        [35.370267,139.430495],
                        [35.370473,139.428474],
                        [35.372949,139.430276],
                        [35.375853,139.430632],
                        [35.380682,139.433494],
                        [35.38533,139.415522],
                        [35.380044,139.402069],
                        [35.384522,139.399945],
                        [35.388505,139.402918],
                        [35.390043,139.403889],
                        [35.391093,139.400306],
                        [35.392267,139.398536],
                        [35.402009,139.403525],
                        [35.403321,139.405982],
                        [35.40523,139.407027],
                        [35.407746,139.40726],
                        [35.411863,139.411547],
                        [35.412545,139.411139],
                        [35.414204,139.412013],
                        [35.416267,139.413649],
                        [35.418714,139.412853],
                        [35.4186,139.413221],
                        [35.417603,139.418702],
                        [35.41782,139.41923],
                        [35.417831,139.419263],
                        [35.417676,139.419496],
                        [35.417034,139.420081],
                        [35.417458,139.420351],
                        [35.417493,139.420207],
                        [35.417635,139.420228],
                        [35.417381,139.420459],
                        [35.416778,139.420851],
                        [35.416665,139.421996],
                        [35.416004,139.424251],
                        [35.417775,139.424906],
                        [35.419941,139.424665],
                        [35.419471,139.430348],
                        [35.416932,139.434959],
                        [35.41287,139.441873],
                        [35.407624,139.441444],
                        [35.407558,139.444717],
                        [35.407411,139.449112],
                        [35.408419,139.449384],
                        [35.40915,139.449524],
                        [35.410371,139.451338],
                        [35.410965,139.452069],
                        [35.41064,139.452095],
                        [35.410795,139.452399],
                        [35.410639,139.453279],
                        [35.411181,139.453683],
                        [35.411317,139.453777],
                        [35.411243,139.453821],
                        [35.410925,139.453923],
                        [35.410974,139.454473],
                        [35.410865,139.454799],
                        [35.410239,139.45453],
                        [35.409204,139.455072],
                        [35.410393,139.454852],
                        [35.410874,139.456376],
                        [35.411717,139.456623],
                        [35.424248,139.449873],
                        [35.424877,139.449454],
                        [35.426101,139.449905],
                        [35.426591,139.449916],
                        [35.427229,139.449916],
                        [35.427054,139.450506],
                        [35.426477,139.451857],
                        [35.425953,139.453091],
                        [35.425358,139.453563],
                        [35.425052,139.453874],
                        [35.424676,139.454561],
                        [35.424947,139.455065],
                        [35.424641,139.455559],
                        [35.424606,139.455848],
                        [35.424186,139.456127],
                        [35.423706,139.456245],
                        [35.423592,139.456685],
                        [35.423627,139.457361],
                        [35.424041,139.458011],
                        [35.423565,139.45817],
                        [35.424109,139.458535],
                        [35.423849,139.459369],
                        [35.423008,139.459824],
                        [35.422674,139.460006],
                        [35.422303,139.460105],
                        [35.422244,139.460779],
                        [35.422821,139.461884],
                        [35.42317,139.462378],
                        [35.423433,139.463451],
                        [35.42345,139.464824],
                        [35.423651,139.466929],
                        [35.423563,139.470923],
                        [35.422348,139.473144],
                        [35.421998,139.474163],
                        [35.420835,139.475987],
                        [35.419559,139.477854],
                        [35.417124,139.477495],
                        [35.416101,139.477114],
                        [35.414438,139.475829],
                        [35.412694,139.476118],
                        [35.408292,139.475543],
                        [35.40374,139.475336],
                        [35.402,139.47474],
                        [35.398963,139.477167],
                        [35.396545,139.477008],
                        [35.395203,139.47722],
                        [35.393744,139.478039],
                        [35.391252,139.479562],
                        [35.389147,139.481184],
                        [35.388346,139.483136],
                        [35.389372,139.481057],
                        [35.387854,139.483532],
                        [35.386473,139.484445],
                        [35.383823,139.484922],
                        [35.381417,139.487244],
                        [35.378042,139.492439],
                        [35.373658,139.489967],
                        [35.371068,139.488379],
                        [35.365698,139.48818],
                        [35.360413,139.485578],
                        [35.359556,139.485455],
                        [35.358391,139.489142],
                        [35.358807,139.489308],
                        [35.358422,139.491005],
                        [35.358496,139.492615],
                        [35.357122,139.495479],
                        [35.355731,139.502517],
                        [35.3532,139.50496],
                        [35.350889,139.503523],
                        [35.351885,139.505536],
                        [35.352115,139.505798],
                        [35.352026,139.506189],
                        [35.351886,139.506147],
                        [35.351639,139.506693],
                        [35.351809,139.506809],
                        [35.351991,139.506904],
                        [35.351888,139.507105],
                        [35.351796,139.507332],
                        [35.351741,139.507325],
                        [35.351326,139.507036],
                        [35.351134,139.507257],
                        [35.351077,139.507276],
                        [35.350979,139.507121],
                        [35.350853,139.5072],
                        [35.351054,139.507705],
                        [35.351185,139.507883],
                        [35.351348,139.508067],
                        [35.351709,139.508388],
                        [35.351903,139.508392],
                        [35.352003,139.508549],
                        [35.351935,139.508792],
                        [35.351723,139.50883],
                        [35.351417,139.508768],
                        [35.351335,139.508914],
                        [35.351067,139.508842],
                        [35.351052,139.508636],
                        [35.351104,139.508559],
                        [35.351056,139.50844],
                        [35.350966,139.508445],
                        [35.350732,139.508697],
                        [35.350645,139.508939],
                        [35.350266,139.508848],
                        [35.349907,139.508767],
                        [35.349798,139.508781],
                        [35.349662,139.508729],
                        [35.349572,139.508946],
                        [35.349211,139.509424],
                        [35.348807,139.509464],
                        [35.349625,139.508807],
                        [35.349487,139.509011],
                        [35.349384,139.509171],
                        [35.349294,139.509273],
                        [35.349172,139.509461],
                        [35.348971,139.509432],
                        [35.348911,139.509904],
                        [35.348893,139.510013],
                        [35.34888,139.510083],
                        [35.348854,139.510203],
                        [35.348825,139.51027],
                        [35.348797,139.510302],
                        [35.34857,139.510148]
                    ]);
                }, false);
                
                // clearボタン
                document.getElementById("clearButton").addEventListener("click", function () {
                    MapManager.clearPolyline();
                }, false);
                
            }

</script>
</body>
</html>
